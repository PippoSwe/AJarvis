<!DOCTYPE html>
<html>
    <head>
        <title>Configurazione | AJarvis</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <!--#include virtual="/assets/tpl/meta.html"-->
    </head>
    <body>
        <div class="app">
            <div class="app-body">
                <!--#include virtual="/assets/tpl/sidebar.html"-->
                
                <div class="app-content">
                    <!--#include virtual="/assets/tpl/navbar.html"-->
                    <!-- breadcrumb -->
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item">Home</li>
                            <li class="breadcrumb-item active" aria-current="page">Configurazione</li>
                        </ol>
                    </nav>
                    <!-- content -->
                    <div class="container-fluid">
                        <div id="message"></div>
                        <div class="container">
                            <div class="row">
                                <div class="col"></div>
                                <div class="card w-75">
                                    <div class="card-header">
                                        <i class="fa fa-file-code-o pr-2"></i>Parametri configurazione
                                    </div>
                                    <div class="card-body">
                                        <form id="save">
                                            <div class="form-group">
                                                <label for="audio_bucket_name">Audio bucket name</label>
                                                <input type="text" class="form-control" name="audio_bucket_name" id="audio_bucket_name">
                                            </div>
                                            <div class="form-group">
                                                <label for="key_file">Key file</label>
                                                <textarea class="form-control" name="key_file" id="key_file"></textarea>
                                            </div>
                                            <div class="form-group">
                                                <label for="ip">IP</label>
                                                <input type="text" class="form-control" name="ip" id="ip">
                                            </div>
                                            <div class="form-group">
                                                <label for="port">Port</label>
                                                <input type="text" class="form-control" name="port" id="port">
                                            </div>
                                            <div class="text-center">
                                                <button type="submit" class="btn btn-success" disabled="true" id="saveButton"><i class="ion-ios-checkmark-outline mr-2"></i>Salva</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <!-- Managing projects -->
                        <div class="container mt-5 mt-lg-5" id="list"> &nbsp </div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            $( document ).ready(function() {
                checkEventInput();

                $.ajax({
                    url: '/api/config/read/',
                    type: "GET",
                    success: function (data) {
                        if (data.length > 0)
                            $('#audio_bucket_name').val(data[0].value);
                            $('#key_file').val(data[1].value);
                            $('#ip').val(data[2].value);
                            $('#port').val(data[3].value);
                    }
                });

                $('#saveButton').click(function () {
                    $.ajax({
                        url: '/api/config/update/',
                        type: "POST",
                        data: $("#save").serialize()
                    })
                });
            });

            function checkEventInput() {
                $("#audio_bucket_name").keyup(function() {
                    checkEmpty();
                });

                $("#key_file").keyup(function() {
                    checkEmpty();
                });

                $("#ip").keyup(function() {
                    checkEmpty();
                });

                $("#port").keyup(function() {
                    checkEmpty();
                });
            }

            function checkEmpty() {
                if( $("#audio_bucket_name").val().length > 0 && $("#key_file").val().length > 0 && $("#ip").val().length > 0 && $("#port").val().length > 0)
                    $("#saveButton").attr("disabled",false);
                else $("#saveButton").attr("disabled",true);
            }
        </script>
        
    </body>
</html>